{let o=(e,t,r)=>e?.querySelectorAll(t).forEach(r),r=e=>o(e,"template[_]",l=>{o(document,l.getAttribute("_"),r=>{let t=l.innerHTML;l.getAttributeNames().forEach(e=>"_"!=e&&(t=t.replaceAll(`{${e}}`,r.getAttribute(e)||l.getAttribute(e)))),t=t.replaceAll(/{\$(\S+?)}/g,(e,t)=>r[t].outerHTML||r[t]),r.innerHTML=t,o(r,"if",e=>e.replaceWith(...e.getAttributeNames().some(e=>"!"==e[0]!=r.hasAttribute(e.replace(/^!/,"")))?e.childNodes:[])),r.outerHTML=r.innerHTML}),l.remove()});r(document),o(document,".template-import",t=>t.onload=e=>{r(t.contentDocument),t.remove()})}